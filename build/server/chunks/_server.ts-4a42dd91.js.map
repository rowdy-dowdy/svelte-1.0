{"version":3,"file":"_server.ts-4a42dd91.js","sources":["../../../.svelte-kit/adapter-node/entries/endpoints/api/v1/messages/_roomId_/_server.ts.js"],"sourcesContent":["import { e as error, j as json } from \"../../../../../../chunks/index2.js\";\nimport { p as prisma } from \"../../../../../../chunks/prismadb.js\";\nconst perPage = 15;\nconst GET = async ({ locals, request, cookies, params, url }) => {\n  let user_id = locals.session?.user?.id;\n  if (!user_id) {\n    throw error(401, \"Unauthorized\");\n  }\n  let roomId = params.roomId;\n  let page = +url.searchParams.get(\"page\") || 1;\n  const messages = await prisma.messages.findMany({\n    take: perPage,\n    skip: (page - 1) * perPage,\n    where: {\n      room: {\n        users: {\n          some: {\n            id: user_id\n          }\n        },\n        id: roomId\n      }\n    },\n    orderBy: { createdAt: \"desc\" }\n  });\n  return json({ messages, page, perPage });\n};\nexport {\n  GET\n};\n"],"names":[],"mappings":";;;;AAEA,MAAM,OAAO,GAAG,EAAE,CAAC;AACd,MAAC,GAAG,GAAG,OAAO,EAAE,MAAM,EAAE,OAAO,EAAE,OAAO,EAAE,MAAM,EAAE,GAAG,EAAE,KAAK;AACjE,EAAE,IAAI,OAAO,GAAG,MAAM,CAAC,OAAO,EAAE,IAAI,EAAE,EAAE,CAAC;AACzC,EAAE,IAAI,CAAC,OAAO,EAAE;AAChB,IAAI,MAAM,KAAK,CAAC,GAAG,EAAE,cAAc,CAAC,CAAC;AACrC,GAAG;AACH,EAAE,IAAI,MAAM,GAAG,MAAM,CAAC,MAAM,CAAC;AAC7B,EAAE,IAAI,IAAI,GAAG,CAAC,GAAG,CAAC,YAAY,CAAC,GAAG,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;AAChD,EAAE,MAAM,QAAQ,GAAG,MAAM,MAAM,CAAC,QAAQ,CAAC,QAAQ,CAAC;AAClD,IAAI,IAAI,EAAE,OAAO;AACjB,IAAI,IAAI,EAAE,CAAC,IAAI,GAAG,CAAC,IAAI,OAAO;AAC9B,IAAI,KAAK,EAAE;AACX,MAAM,IAAI,EAAE;AACZ,QAAQ,KAAK,EAAE;AACf,UAAU,IAAI,EAAE;AAChB,YAAY,EAAE,EAAE,OAAO;AACvB,WAAW;AACX,SAAS;AACT,QAAQ,EAAE,EAAE,MAAM;AAClB,OAAO;AACP,KAAK;AACL,IAAI,OAAO,EAAE,EAAE,SAAS,EAAE,MAAM,EAAE;AAClC,GAAG,CAAC,CAAC;AACL,EAAE,OAAO,IAAI,CAAC,EAAE,QAAQ,EAAE,IAAI,EAAE,OAAO,EAAE,CAAC,CAAC;AAC3C;;;;"}